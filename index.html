<!DOCTYPE html>
<html>
  <head>
    <title>Product Description Generator</title>
    <style>
      /* Add your CSS styles here */
    </style>
  </head>
  <body>
    <form id="product-form">
      <label for="product-name">Product Name:</label>
      <input type="text" id="product-name" name="product-name"><br><br>
      <label for="product-details">Product Details:</label>
      <textarea id="product-details" name="product-details"></textarea><br><br>
      <label for="product-type">Product Type:</label>
      <select id="product-type" name="product-type">
        <option value="Tee">Tee</option>
        <option value="Hoodie">Hoodie</option>
        <option value="Tank Top">Tank Top</option>
      </select><br><br>
      <label for="product-image">Product Image:</label>
      <input type="file" id="product-image" name="product-image"><br><br>
      <button type="submit" id="create-description">Create Description</button>
    </form>

    <p id="ai-product-description"></p>
    <img id="processed-image" style="display: none;">

    <script>
      const form = document.querySelector('#product-form');
      const product_name = document.querySelector('#product-name');
      const product_details = document.querySelector('#product-details');
      const product_type = document.querySelector('#product-type');
      const product_image = document.querySelector('#product-image');
      const ai_product_description = document.querySelector('#ai-product-description');
      const processed_image = document.querySelector('#processed-image');

      const netlify_function_url = 'https://your-app-name.netlify.app/.netlify/functions/remove-background';

      form.addEventListener('submit', async (event) => {
        event.preventDefault();

        if (product_image.files.length > 0) {
          const imageFile = product_image.files[0];
          const formData = new FormData();
          formData.append('image', imageFile);

          try {
            const response = await fetch(netlify_function_url, {
              method: 'POST',
              body: formData,
            });

            const data = await response.json();
            const imageUrl = data.imageUrl;
            processed_image.src = imageUrl;
            processed_image.style.display = 'block';

          } catch (error) {
            console.log('Error removing background:', error);
          }
        }

        const prompt = `Generate a product description for ${product_name.value}, a ${product_type.value} that ${product_details.value}.`;
        const api_key = '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';
        const model = 'text-davinci-002';
        const url = `https://api.openai.com/v1/engines/${model}/completions`;
        const body = {
          prompt,
          max_tokens: 500,
          n: 1,
          stop: '.',
        };
        const headers = {
          'Content-Type': 'application/json',
          Authorization: `Bearer ${api_key}`,
        };

        fetch(url, {
          method: 'POST',
          body: JSON.stringify(body),
          headers: headers,
        })
          .then((response) => response.json())
          .then((data) => {
            const product_description = data.choices[0].text.trim();
            ai_product_description.textContent = product_description;
          })
      .catch((error) => console.log(error));
  });
</script>
  </body>
</html>
